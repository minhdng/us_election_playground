---
title: "Exploratory Analysis of US Election Survey Data ANES"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# knit option
knitr::opts_chunk$set(echo = FALSE)
```


```{r packages, results="hide", message=FALSE}
# Loading necessary packages
library(dplyr)
library(ggplot2)
library(knitr)
library(grid)
library(gridExtra)
opts_knit$set(root.dir=normalizePath('../')) # change dir to project root
```



# 1. Introduction 

The *American National Election Studies* (ANES) are surveys of voters in the U.S. on the national scale. For each presidential election since 1948, ANES collects response both before and after the election. The goal of ANES is to understand political behaviors using systematic surveys. ANES data and results are widely used by news outlets, election campaigns and political researchers.

The *Time Series Cumulative Data* of ANES include answers from respondents from different years on selected questions asked in three or more ANES *time series* studies. Tremendous amount of efforts have been put into data consolidation as the questions and answers vary by year. 

To understand its study design and data collection process, you are strongly encouraged to read the *codebooks*. 

In this notebook, we are interested in the education distribution per party. 
Specifically, we look to answer: are more educated people more liberal or conservative? 

In my experience in undergraduate and post-graduate, most people are liberal. 
Thus my intuition is there will be a correlation between higher education degree and more liberal political view. 

# 2. Access to ANES data

## 2.1. Register to access ANES dataset

To access the data, you should register at ANES [website](https://electionstudies.org/) and accept its terms of use.

## Step 2.2: Download the ANES Time Series Cumulative Data
Once you are logged into ANES website, you should be able to download the data file. You can use ASCII, DTA or SAV. In this notebook, we use the *SAV* format. The downloaded file is a zip file. All unzipped files are moved i`data/`.

<img src="../figs/folders.png" width="150">

# 3. Data processing for this R Notebook.

The following code blocks prepare a processed data set and save it in the `output` folder. The data folder should be only used for storing raw `data`. All processed data should be saved in the `output` folder. The notion here is that one can delete files from the output folder and reproduce them by re-running the codes. 

<img src="../figs/folders2.png" width="150">

### Step 3.1 Checking `R` packages for data processing

From the packages' descriptions:

+ `tidyverse` is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures;
+ `haven` enables `R` to read and write various data formats used by other statistical packages. `haven` is part of the `tidyverse`.
+ `devtools` provides a collection of package development tools.
+ `RColorBrewer` provides ready-to-use color palettes.
+ `DT` provides an R interface to the JavaScript library DataTables;
+ `ggplot2` a collection of functions for creating graphics, based on The Grammar of Graphics.





## Correlation of education and party identification


Import processed data. 
We take a look at the education distribution of the voters versus political identification. 

```{r}
data1 <- read.csv("output/anes_edu.csv", header=TRUE)
```

For instance, in 2016, how many legit answers are there in total? 

```{r}
data2 <- data1[ data1$year == 2016,  ]
table1data <- t (c( dim(data2)[1], 
                            sum(data2$partyID == 1), 
                            sum(data2$partyID == 3)
))
table1 <- as.data.frame( table1data )
names(table1) <- c("No. Response 2016", 
                   "Democrat", 
                   "Republican")
print(table1)
```

What are the education distribution among these? Let us sort by 

```{r}
table2data <- rbind( 
    t((data2[data2$partyID == 1,] %>% count(eduID)*100/sum(data2$partyID == 1))[2]), 
    t((data2[data2$partyID == 3,] %>% count(eduID)*100/sum(data2$partyID == 3))[2])
)
table2 <- data.frame(table2data)
names(table2) <- c("Grade School", "High School", "Some Colleges", "College or higher")
row.names(table2) <- c("Democrat", "Republican")
print(table2)
```

It seems like so far in 2016, people who have college degrees and higher tend to identify themselves as democrat, though the ratio is not much higher. 

Let us look at the data accross the years. This is slightly longer, thus relegated to `edu.R`

```{r}
# histogram time series to plot
frequency <- data1 %>% count(year, eduID, partyID)

# add new col number of people per party, rescale to fit frequency
partySum <- (data1 %>% count(year, partyID))
partySum.expanded <- partySum[ rep(row.names(partySum), each=4) , 2:3 ]

# sort by frequency file by partyID
frequency <- frequency[ order(frequency$year, frequency$partyID) , ]

# then add new column of partySum
frequency[, 5] <- partySum.expanded[, 2]                        

# add new col of percentage
frequency[, 6] <- frequency[, 4] / frequency[, 5] * 100

# change labels
names(frequency) <- c("year", "eduID", "partyID", 
                      "count", "partySum", "percentage" )

# change eduID labels
eduLabel <- data.frame( 
    ID = c(1,2,3,4), 
    level = c("1 Grade School", "2 Highschool", "3 Some College", "4 College")
)

frequency$eduID <- eduLabel$level[ match(frequency$eduID, eduLabel$ID) ]

# graph
ggplot( 
    data=frequency, 
    aes(
        x=year, 
        y=percentage, 
        colour=as.factor(partyID)
        )
) + 
geom_point() + 
geom_line() +
facet_wrap(frequency$eduID ~ .) + 
scale_color_manual(
    name="Party Identification",
    labels=c("Dem", "Ind", "Rep"),
    values=c("blue","brown","red")
) +
scale_x_continuous( limits=c(1948,2020) )
```

Looking at the previous years tell a different story. It seems that across the years, a Democrat will likely in the first two categories (`Grade school` and `High School`), while a Republican will more likely in the other two (`Some colleges` and `College or higher`). To render our analysis more quantitative, let us look at the average across the years

```{r}

# count by eduID only
dataBox <- (data1 %>% count(year, eduID))
# Make two new columns of total Dem and Rep
dataBox[, 4] <- (data1[ data1$partyID == 1, ] %>% count(year, eduID))$n
dataBox[, 5] <- (data1[ data1$partyID == 3, ] %>% count(year, eduID))$n
# input total number of dem and rep
foo5 <- (data1 %>% count(year, partyID))$n
foo6 <- as.data.frame(t(matrix(foo5, nrow=3, ncol=length(foo5)/3)))
foo6.expanded <- foo6[ rep(row.names(foo6), each=4) , c(1,3) ]
dataBox[, 6:7] <- foo6.expanded
# probability
dataBox[, 8] <- dataBox[, 4] / dataBox[, 6] * 100
dataBox[, 9] <- dataBox[, 5] / dataBox[, 7] * 100
# probability difference
dataBox[, 10] <- dataBox[, 8] - dataBox[, 9]


names(dataBox) <- c("year", "eduID", "tot", "dem", "rep",
                 "demTot", "repTot", "P(dem)", "P(rep)", "spread")

# plot
dataBox$eduID <- as.factor(dataBox$eduID)
ggplot(dataBox, aes(x=eduID, y=spread)) + geom_boxplot()
```

This boxplot indicates two things:
* Less educated respondents tend to identify as democrats. More educated respondents tend to identify as republicans. 
* 2016 is a outlier for the `college and higher` category, while 2012 is a outlier for the `some colleges` category. 



## Correllation to `temperature` data

Temperature data measure respondents' feeling toward a certain keyword. Let us take a look at a few significant keywords. First, let see how each group feels toward `Democratic Party`. 


```{r}
dataFull <- read.csv("output/anes_trimmed.csv", header=TRUE)

data3 <- as.data.frame( 
    cbind(dataFull$VCF0004,  dataFull$VCF0218, dataFull$VCF0110)
)

# clean NA and invalid entries and non valid temperatures
data3 <- data3[ complete.cases(data3), ]
data3 <- data3[(data3$V2 != 98) & (data3$V2 != 99), ]
data3 <- data3[data3$V3 != 0, ]

# year extract
data4 <- data3[ data3$V1 == 2016, ]

data3$V3 <- as.factor(data3$V3)
data4$V3 <- as.factor(data4$V3)
p1 <- ggplot(data3, aes(x=V3, y=V2)) + geom_boxplot()  
p2 <- ggplot(data4, aes(x=V3, y=V2)) + geom_boxplot()

grid.arrange(p1, p2, ncol=2,
    top = textGrob("Thermometer - Democratic Party", gp=gpar(fontsize=20,font=3)))
```

It seems that the feeling toward the Democrat Party is not as hot in 2016, but the change uniform across the board. What about the `Republican Party` ? 

```{r}
data3 <- as.data.frame( 
    cbind(dataFull$VCF0004,  dataFull$VCF0224, dataFull$VCF0110)
)

# clean NA and invalid entries and non valid temperatures
data3 <- data3[ complete.cases(data3), ]
data3 <- data3[(data3$V2 != 98) & (data3$V2 != 99), ]
data3 <- data3[data3$V3 != 0, ]

# year extract
data4 <- data3[ data3$V1 == 2016, ]

data3$V3 <- as.factor(data3$V3)
data4$V3 <- as.factor(data4$V3)
p1 <- ggplot(data3, aes(x=V3, y=V2)) + geom_boxplot()  
p2 <- ggplot(data4, aes(x=V3, y=V2)) + geom_boxplot()

grid.arrange(p1, p2, ncol=2,
    top = textGrob("Thermometer - Republican Party", gp=gpar(fontsize=20,font=3)))
```

Contrary to the graph above, the feeling toward the Republican Party stays the same for all less educated groups, and only decrease for the `College Degree or Higher` group. This suggest that in 2016, it's not that *less* educated people vote for Republican, but rather *more* uneducated people vote for Republican. 

This still does not explain why the Republican appeal better to the fourth group in general, while the Democrat party appeal to the less educated group. Taking a look at a few other keywords may reveal the reasons. 

```{r}
data3 <- as.data.frame( 
    cbind(dataFull$VCF0004,  dataFull$VCF0223, dataFull$VCF0110)
)

# clean NA and invalid entries and non valid temperatures
data3 <- data3[ complete.cases(data3), ]
data3 <- data3[(data3$V2 != 98) & (data3$V2 != 99), ]
data3 <- data3[data3$V3 != 0, ]

# year extract
data4 <- data3[ data3$V1 == 2016, ]

data3$V3 <- as.factor(data3$V3)
data4$V3 <- as.factor(data4$V3)
p1 <- ggplot(data3, aes(x=V3, y=V2)) + geom_boxplot()  
p2 <- ggplot(data4, aes(x=V3, y=V2)) + geom_boxplot()

grid.arrange(p1, p2, ncol=2,
    top = textGrob("Thermometer - White", gp=gpar(fontsize=20,font=3)))
```






```{r, echo=FALSE, results="hide", message=FALSE}
library(tibble)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(patchwork)
library(RColorBrewer)
library(gridExtra)
library(data.table)
library(tm)
library(SnowballC)
library(wordcloud)
library(grid)
```

```{r setup, echo=FALSE}
library(knitr)
opts_knit$set(root.dir=normalizePath("../"))
```

# A little bit about our data

The goal of this project is to look deeper in to voter's background and voting behaviors. using  the data from the American National Election Studies (ANES). I worked with the cumulative time series data file (1948-2016). The raw data consists of 59944 obs with 1029 variables. I then cleaned and subset the data for the purpose of this project accordingly. The processed data could be found in the output folder. 

# Introduction

This report, hopefully, will help you understand what make up the majority of Democratic and Republican voting base, their preference, what they like about their parties of choice. Some other criteria that this report covers including: education background, the voters feelings toward immigration for each different education groups. I also had a special interest in looking at the voting trend in 2016. 

There are 3 main questions that I want to answer in this project:
- What are the voter' education levels distribution for each party?
- Why do one voters like/dislike a particular party?
- Trump's immigration agenda-does it make sense?


# Question 1: Republican vs Democratics: which party has a "smarter" voting base?

Graduated from a liberal art college in dominantly blue state, Minnesota, I have always believe that people who support Democratic party are smarter, more educated, hence the liberal points of views, in comparison to Republican supporters. At least, that is what my American classmates told me. I wonder if that is true. 

To answer this question, I take a look at the education distribution of the voters versus political identification. I started with 2016, which to many people, had the most unexpected election outcomes. 

```{r, echo =FALSE}
data1 <- read.csv("output/anes_edu.csv", header=TRUE)
```


```{r, echo=FALSE}
data2 <- data1[ data1$year == 2016,  ]
a<- t((data2[data2$partyID == 1,] %>% count(eduID)*100/sum(data2$partyID == 1))[2])
b<- t((data2[data2$partyID == 3,] %>% count(eduID)*100/sum(data2$partyID == 3))[2])
edubyparty<-rbind(a,b)
edubyparty<-as.data.frame(edubyparty)
names(edubyparty)<- c("Grade School", "High School", "Some Colleges no degree", "College or higher")
rownames(edubyparty)<-c("Democratics", "Republican")
print(edubyparty)
```

It seems like so far in 2016, people who have college degrees and higher tend to identify themselves as democrat, though the ratio is not much higher.

Let us look at the data across the year, to see if this phenomenon still apply over time

```{r, echo=FALSE}
# histogram time series to plot
frequency <- data1 %>% count(year, eduID, partyID)
# add new col number of people per party, rescale to fit frequency
partySum <- (data1 %>% count(year, partyID))
partySum.expanded <- partySum[ rep(row.names(partySum), each=4) , 2:3 ]
# sort by frequency file by partyID
frequency <- frequency[ order(frequency$year, frequency$partyID) , ]
# then add new column of partySum
frequency[, 5] <- partySum.expanded[, 2]                        
# add new col of percentage
frequency[, 6] <- frequency[, 4] / frequency[, 5] * 100
# change labels
names(frequency) <- c("year", "eduID", "partyID", 
                      "count", "partySum", "percentage" )
# change eduID labels
eduLabel <- data.frame( 
    ID = c(1,2,3,4), 
    level = c("1 Grade School", "2 Highschool", "3 Some College no degree", "4 College")
)
frequency$eduID <- eduLabel$level[ match(frequency$eduID, eduLabel$ID) ]
# graph
ggplot( 
    data=frequency, 
    aes(
        x=year, 
        y=percentage, 
        colour=as.factor(partyID)
        )
) + 
geom_point() + 
geom_line() +
facet_wrap(frequency$eduID ~ .) + 
scale_color_manual(
    name="Party Identification",
    labels=c("Dem", "Ind", "Rep"),
    values=c("blue","brown","red")
) +
scale_x_continuous( limits=c(1948,2020) )
```

Contrary to my beliefs, 2016 is an anomaly.It seems that across the years, Democrats voter base fall mostly into the two categories: (`Grade school` and `High School`), while a Republican voters will more likely fall into the other two groups (`Some colleges` and `College or higher`).

Across the years, there has been a decline in voters without a college degree. College-educated voters, on the other hand, have increased, according to the analysis. There have been more and more people went to get higher degrees, thus introducing an upward trends in some college and colleges education groups on the graph. 

This realization came to me as a total surprise. The stereotype I learned in college, saying that Republicans voters are less educated than Democrats is wrong.  To render my analysis more quantitative, I look at percentage difference between the Democrats and Republicans for each of the educational groups

```{r, echo=FALSE}
# count by eduID only
dataBox <- (data1 %>% count(year, eduID))
# Make two new columns of total Dem and Rep
dataBox[, 4] <- (data1[ data1$partyID == 1, ] %>% count(year, eduID))$n
dataBox[, 5] <- (data1[ data1$partyID == 3, ] %>% count(year, eduID))$n
# input total number of dem and rep
foo5 <- (data1 %>% count(year, partyID))$n
foo6 <- as.data.frame(t(matrix(foo5, nrow=3, ncol=length(foo5)/3)))
foo6.expanded <- foo6[ rep(row.names(foo6), each=4) , c(1,3) ]
dataBox[, 6:7] <- foo6.expanded
# probability
dataBox[, 8] <- dataBox[, 4] / dataBox[, 6] * 100
dataBox[, 9] <- dataBox[, 5] / dataBox[, 7] * 100
# probability difference
dataBox[, 10] <- dataBox[, 8] - dataBox[, 9]
names(dataBox) <- c("year", "eduID", "tot", "dem", "rep",
                 "demTot", "repTot", "P(dem)", "P(rep)", "spread")
# plot
dataBox$eduID <- as.factor(dataBox$eduID)
ggplot(dataBox, aes(x=eduID, y=spread))+
        xlab("Education groups")+
        ylab("Percentage")+
        geom_boxplot(aes(factor(eduID), spread))+
        scale_x_discrete(labels = c("Grade school", "High school", "Some College no degree", "College degree"))
```

This boxplot indicates two things:

- People with high school degree or lower tend to vote for democrats more. On the other hands, Republicans have a stronger base in higher educational groups (college degree or higher). 
-  2016 is an outlier for the `college and higher` category, while 2012 is an outlier for the `some colleges` category. This means that there was a shift in political preference among the higher educational groups in 2016, as more people with college degree vote for democrats than for republicans.  

# Question 2: What make a person choose one party over the other?

I tried to reason the political preference for each different educational background by looking at voter answers to the questions: what do voters like/don't like about the party? I analyzed their answers, and made word cloud plots based on the frequency that key words popped up. The plots gave some interesting insights on the each party's characteristics. 

```{r, echo=FALSE}
data1<-read.table("output/anes_trimmed.csv", header = TRUE, sep=",")
```


```{r, echo=FALSE}
likedem<-data1$VCF0375b
likedem2<-data1$VCF0376b
likedem3<-data1$VCF0377b
likedem4<- data1$VCF0378b
likedem5<- data1$VCF0379b
likedem<-as.data.frame(likedem)
colnames(likedem)<-"LikeID"
likedem2<-as.data.frame(likedem2)
names(likedem2)<-"LikeID"
likedem3<-as.data.frame(likedem3)
names(likedem3)<-"LikeID"
likedem4<-as.data.frame(likedem4)
names(likedem4)<-"LikeID"
likedem5<-as.data.frame(likedem5)
names(likedem5)<-"LikeID"
likedem_total<-rbind(likedem,likedem2,likedem3, likedem4, likedem5)
likedem_total<-likedem_total[!is.na(likedem_total)]
likedem_total<-as.data.frame(likedem_total)
names(likedem_total)<- "LikeID"
#create data frame used for label
like_label <- data.frame(
        ID = c(11, 12,21,22,23,24,31,32,33,34,35,40,50), 
        Reason = c("PeopleinParty", 
                   "PartyCharacter", 
                   "Candidate Ability", 
                   "Leadership Qualities",
                   "Candidate Personal Qualities", 
                   "Party Connection", 
                   "Management", 
                   "Philosophy", 
                   "DomesticPolicy", 
                   "F-Policies",
                   "GroupConnect", 
                   "Etc",
                   "Events Unique to One campaign"
        )
)
### Match label with the LikeID
likedem_total$LikeID <- like_label$Reason[match(likedem_total$LikeID, like_label$ID)]
### CREATE WORD CLOUD PLOT
text3<-likedem_total$LikeID
wc <- count(likedem_total, LikeID)
wordcloud(words=wc$LikeID, freq = wc$n, scale=c(2,.5), random.order = FALSE,rot.per=.5)
```

```{r,echo=FALSE}
likerep<-data1$VCF0387b
likerep2<-data1$VCF0388b
likerep3<-data1$VCF0389b
likerep4<- data1$VCF0390b
likerep5<- data1$VCF0391b
likerep<-as.data.frame(likerep)
names(likerep)<-"LikeID"
likerep2<-as.data.frame(likerep2)
names(likerep2)<-"LikeID"
likerep3<-as.data.frame(likerep3)
names(likerep3)<-"LikeID"
likerep4<-as.data.frame(likerep4)
names(likerep4)<-"LikeID"
likerep5<-as.data.frame(likerep5)
names(likerep5)<-"LikeID"
likerep_total<-rbind(likerep,likerep2, likerep3, likerep4, likerep5)   
likerep_total<-likerep_total[!is.na(likerep_total)]
likerep_total<-as.data.frame(likerep_total)
names(likerep_total)<- "LikeID"
likerep_total$LikeID <- like_label$Reason[match(likerep_total$LikeID, like_label$ID)]
## Plotting
text4<-likerep_total$LikeID
wc2 <- count(likerep_total, LikeID)
wordcloud(words=wc2$LikeID, freq = wc2$n, scale=c(2,.5), random.order = FALSE,rot.per=.5)
```

Democratic party win voters favor with their Group Connection quality, and their Domestic Policies. Voters, on the other hand, resonance with Republican Party on their Domestic Policy, Philosophy, Management skills. 

We repeat the same process to answer the question: what does voters hate about each parties: 


```{r, echo=FALSE}
# ATTEMPT DISLIKE about DEMOCRATIC PARTY
dislikedem<-data1$VCF0381b
dislikedem<-dislikedem[!is.na(dislikedem)]
dislikedem<-as.data.frame(dislikedem)
names(dislikedem)<-"DislikeID"
#VCF0382
dislikedem3<-data1$VCF0382b
dislikedem3<-dislikedem3[!is.na(dislikedem3)]
dislikedem3<-as.data.frame(dislikedem3)
names(dislikedem3)<-"DislikeID"
## VCF0383
dislikedem6<-data1$VCF0383b
dislikedem6<-dislikedem6[!is.na(dislikedem6)]
dislikedem6<-as.data.frame(dislikedem6)
names(dislikedem6)<-"DislikeID"
## VCF0384
dislikedem5<-data1$VCF0384b
dislikedem5<-dislikedem5[!is.na(dislikedem5)]
dislikedem5<-as.data.frame(dislikedem5)
names(dislikedem5)<-"DislikeID"
# rbind and make new data frame
dislikedem_total<-rbind(dislikedem, dislikedem3, dislikedem6, dislikedem5)
# match the dislikeID with answer key
dislike_label1 <- data.frame(
        ID = c(11, 12,21,22,23,24,31,32,33,34,35,40,50), 
        Reason = c("PeopleinParty", 
                 "PartyCharacter", 
                 "Candidate Ability", 
                 "Leadership Qualities",
                 "Candidate Personal Qualities", 
                 "Party Connection", 
                 "Management", 
                 "Philosophy", 
                 "DomesticPolicy", 
                 "F-Policies",
                 "GroupConnect", 
                 "Etc",
                 "Events Unique to One campaign"
                 )
        )
dislike_label2 <- data.frame(
        ID= c(1,2,3,4,5,6,7,8,9,10), 
        Reason= c("PeopleinParty",
                  "Management", 
                  "Philosophy", 
                  "DomesticPolicy", 
                  "DomesticPolicy", 
                  "ForeignPolicy", 
                  "Bad for groups of interest", 
                  "Good for group of interest", 
                  "Party Attitude",
                  "Others"
                  )
        )
dislike_label<-rbind(dislike_label1, dislike_label2)
#match label with factor in main data frame
dislikedem_total$DislikeID <- dislike_label$Reason[
        match( dislikedem_total$DislikeID, dislike_label$ID )
        ]
####### CREATE WORD CLOUD PLOT
text<-dislikedem_total$DislikeID
cd2 <- count(dislikedem_total, DislikeID)
wordcloud(words=cd2$DislikeID, freq = cd2$n,scale=c(2,.5), random.order = FALSE,rot.per=.5)
```

```{r, echo=FALSE}
dislikerep<-data1$VCF0393b
dislikerep2<-data1$VCF0394b
dislikerep4<- data1$VCF0395b
dislikerep5<- data1$VCF0396b
dislikerep6<- data1$VCF0397b
# create dataframe and rename column
dislikerep<-as.data.frame(dislikerep)
names(dislikerep)<-"DislikeID"
dislikerep2<-as.data.frame(dislikerep2)
names(dislikerep2)<-"DislikeID"
dislikerep4<-as.data.frame(dislikerep4)
names(dislikerep4)<-"DislikeID"
dislikerep5<-as.data.frame(dislikerep5)
names(dislikerep5)<-"DislikeID"
dislikerep6<-as.data.frame(dislikerep6)
names(dislikerep6)<-"DislikeID"
dislikerep_total<-rbind(dislikerep, dislikerep2,dislikerep4,dislikerep5,dislikerep6)
dislikerep_total<-dislikerep_total[!is.na(dislikerep_total)]
dislikerep_total<-as.data.frame(dislikerep_total)
names(dislikerep_total)<- "DislikeID"
### Match label with the dislikeID
dislikerep_total$DislikeID <- dislike_label$Reason[match(dislikerep_total$DislikeID, dislike_label$ID)]
### CREATE WORD CLOUD PLOT
text2<-dislikerep_total$DislikeID
cd <- count(dislikerep_total, DislikeID)
wordcloud(words=cd$DislikeID, freq = cd$n, scale=c(2,.5), random.order = FALSE,rot.per=.5)
```

From what the word clouds show, it appears the top common reason that make voters hate one party is Domestic policies. The words "domestic policies", "philosophy" , "party character" showed up on both democratic and republican graph. This is easy to understand, as people have different opinions on how their countries should be run, as well as their philosophies. One interesting thing that we see is  people who disagree with the democratic party' management skill. This does not happen with  the republican party. Apparently, voters across the board think that the democratic party lack credential in their management ability. On the other hand, Group connection quality is among the top reasons why voters don't like republican party.

Connecting this to our previous finding, that higher educated voters prefer republicans, the word cloud plots make total sense. People who have lower income , correlated with less educated background. These people choose Democrats because the party offer a superior group connection quality, with a promise of equal pay, higher tax on the rich, and most importantly, inclusivity for the poor. The voters who have higher education, enjoyed a higher pay positions, want to maintain their social status, so they resonate more with the Republican's conservative philosophy. These voters place an emphasis on the party's management skill in preserving the rich's benefits. 

# Question 3: Why Donald Trump win? Does his agenda make sense?

I looked at the voter's feeling thermometer toward Democratic party across the years, and 2016 specifically: 

```{r,echo=FALSE}
dataFull<-read.table("output/anes_trimmed.csv", header = TRUE, sep=",")
data3 <- as.data.frame( 
    cbind(dataFull$VCF0004,  dataFull$VCF0218, dataFull$VCF0110)
)
# clean NA and invalid entries and non valid temperatures
data3 <- data3[ complete.cases(data3), ]
data3 <- data3[(data3$V2 != 98) & (data3$V2 != 99), ]
data3 <- data3[data3$V3 != 0, ]
# 2016 year extract
data4 <- data3[ data3$V1 == 2016, ]
data3$V3 <- as.factor(data3$V3)
data4$V3 <- as.factor(data4$V3)
# all years
p1 <- ggplot(data3, aes(x=V3, y=V2))+xlab("Education Levels")+ylab("Thermometer level")+
  geom_boxplot(aes(factor(V3), V2))+
  ggtitle("Across Years")+
  scale_x_discrete(labels = c("Grade school", "High school", "Some College no degree", "College degree"), guide=guide_axis(n.dodge = 3)) 
  
p2 <- ggplot(data4, aes(x=V3, y=V2))+ xlab("Education Levels")+ylab("Thermometer level")+
  ggtitle("In 2016")+
  geom_boxplot(aes(factor(V3), V2))+
  scale_x_discrete(labels = c("Grade school", "High school", "Some College no degree", "College degree"), guide=guide_axis(n.dodge = 3)) 
grid.arrange(p1, p2, ncol=2, top = textGrob(" Feelings toward Democratic Party", gp=gpar(fontsize=20,font=3)))
```


```{r,echo=FALSE}
dataFull<-read.table("output/anes_trimmed.csv", header = TRUE, sep=",")
data3 <- as.data.frame( 
    cbind(dataFull$VCF0004,  dataFull$VCF0224, dataFull$VCF0110)
)
# clean NA and invalid entries and non valid temperatures
data3 <- data3[ complete.cases(data3), ]
data3 <- data3[(data3$V2 != 98) & (data3$V2 != 99), ]
data3 <- data3[data3$V3 != 0, ]
# 2016 year extract
data4 <- data3[ data3$V1 == 2016, ]
data3$V3 <- as.factor(data3$V3)
data4$V3 <- as.factor(data4$V3)
# all years
p1 <- ggplot(data3, aes(x=V3, y=V2))+xlab("Education Levels")+ylab("Thermometer level")+
  geom_boxplot(aes(factor(V3), V2))+
  ggtitle("Across Years")+
  scale_x_discrete(labels = c("Grade school", "High school", "Some College no degree", "College degree"), guide=guide_axis(n.dodge = 3)) 
  
p2 <- ggplot(data4, aes(x=V3, y=V2))+ xlab("Education Levels")+ylab("Thermometer level")+
  ggtitle("In 2016")+
  geom_boxplot(aes(factor(V3), V2))+
  scale_x_discrete(labels = c("Grade school", "High school", "Some College no degree", "College degree"), guide=guide_axis(n.dodge = 3)) 
grid.arrange(p1, p2, ncol=2, top = textGrob(" Feelings toward Republican Party", gp=gpar(fontsize=20,font=3)))
```

It turns out, that, there was a decrease in favoritism against Democratic party across different educations groups, especially within the democratic strongest voting base: grade school and high school voters. On the other hand, people's feeling toward Republican party remains relatively unchanged. This means that somehow in 2016, Donald Trump succeed in attracting  voters from the democratic party into his supporting group. 

I then analyzed one of Trump's most prominent agenda: Blocking Immigration, and tried to explain the shift in voting base toward Republicans.


```{r, echo=FALSE}
###  How likely can immigrants steal your job?
data5 <- as.data.frame( 
    cbind(dataFull$VCF0004, dataFull$VCF9223, dataFull$VCF0110)
)
data5 <- data5[complete.cases(data5), ]      #only take complete case
data5 <- data5[(data5$V2 != -8) & (data5$V2 != -9), ]
data5 <- data5[data5$V3 != 0, ]
frequency2 <- data5 %>% count(V1,V2,V3)
# add new col number of people per feeling toward immigrant, rescale to fit frequency
immigrantSum <- (data5 %>% count(V1, V2))
immigrantSum.expanded <- immigrantSum[ rep(row.names(immigrantSum), each=4) , 2:3 ]
# sort by frequency file by partyID
frequency2 <- frequency2[ order(frequency2$V1, frequency2$V2) , ]
# then add new column of partySum
frequency2[, 5] <- immigrantSum.expanded[, 2]                        
# add new col of percentage: how many ppl in an education level respond to immigrant level
frequency2[, 6] <- frequency2[, 4] / frequency2[, 5] * 100
# change labels
names(frequency2) <- c("year", "ImmigrantID", "EduID", 
                      "count", "immigrantSum", "percentage" )
# change eduID labels
eduLabel2 <- data.frame( 
    ID = c(1,2,3,4), 
    level = c("1 Grade School", "2 Highschool", "3 Some College no degree", "4 College")
)
frequency2$EduID<- eduLabel2$level[ match(frequency2$EduID, eduLabel2$ID) ]
# graph
ggplot( 
    data=frequency2, 
    aes(
        x=year, 
        y=percentage, 
        colour=as.factor(ImmigrantID)
        )
)+
  geom_point()+
  geom_line() +
  facet_wrap(frequency2$EduID ~ .)+
  scale_color_manual(
    name="Levels of likeliness",
    labels=c("Extremely likely", "Very likely", "Somewhat likely", "Not likely"),
    values=c("blue","brown","red", "green"))
```


Most people who only have high school degrees think that the chances immigrants stealing their jobs are extremely likely. These people used to mainly support Democratic party. In ` Some College degrees` educational groups, where republicans lead democratic party, there is an uptrend in voters think negatively about immigrants job wise. 

This conclusion explained Trump's aggressive immigration agenda in 2016, where he publicly said that he would build a wall spanning the entirety of the U.S-Mexico border, ban all Muslims from entering the country, deport millions of undocumented immigrants who have lived in the interior of the United States for years, and increase the salary quota and restrictions on highly skilled worker VISA H1B. 

## Trump's agenda sounds idiotic, ruthless yet extremely effective

Trump purposely used his immigration agenda to target and attract democratic voting base: people who have high school and grade school degrees and who strongly believe immigrants are stealing there jobs. 

# Biases 

This section mentioned some biases that should be taken into consideration when looking at the outcomes of this report, as well as the survey conducted by ANES. First of all, people were paid to do the survey. Hence the data may be biased, and not represent the voter population correctly. Secondly, there are difference in sample sizes across years that the survey took place. There was less data recorded in 1990s, compared to, for example 2010-2016.Hence, reader should take analysis related to the volume of voters with a grain of salt. One way to minimize these biases is to utilize error bars. Another potential biases that we should take into account is the effect of the interview administrator. Readers should take in mind the influence of administrator's body language on respondent's answers. 

For all the potential biases above, in this project, I tried to minimize the biases, by taking the difference between Democrats voters and Republican voters, and average them across the years, instead of taking the absolute respondent volume. 


# Conclusion

- People who vote for democratic party are mainly high school and grade school degree holders. On the other hand, Republican party a stronger presence in Higher degree holders (some colleges and higher education).
- Voters commend on Democratics on their group connection quality, domestic policies, while Republicans gain favor through their management skills and also domestic policies.
- Voters hate Democrats for their poor management skills, and Republicans for their lack of group connections. 
- People who only have high school degree think that the chances immigrants stealing their jobs are very likely. People have college degrees or higher don't think so (not likely). Although, we observed some upward trend in the number of people with ` some college` degree thinking negatively about immgration levels impact on the job market. 

